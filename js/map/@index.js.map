{"version":3,"file":"@index.js.map","sources":["@index.js","$.js","main.js","taquin.rotate-touch.js","taquin.hollow-cube.js","taquin.grid.js","taquin.cube.js"],"sourcesContent":["var require = function() {\n    var modules = {};\n    \n    return function(id, body) {\n        var mod;\n        body = window[\"#\" + id];\n        if (typeof body === 'undefined') {\n            var err = new Error(\"Required module is missing: \" + id);   \n            console.error(err.stack);\n            throw err;\n        }\n        mod = modules[id];\n        if (typeof mod === 'undefined') {\n            mod = {exports: {}};\n            var exports = mod.exports;\n            body(exports, mod);\n            modules[id] = mod.exports;\n            mod = mod.exports;\n            //console.log(\"Module initialized: \" + id);\n        }\n        return mod;\n    };\n}();\nfunction addListener(e,l) {\n    if (window.addEventListener) {\n        window.addEventListener(e,l,false);\n    } else {\n        window.attachEvent('on' + e, l);\n    }\n};\n\naddListener(\n    'DOMContentLoaded',\n    function() {\n        document.body.parentNode.$data = {};\n        // Attach controllers.\n        APP = require('main');\nsetTimeout(function (){if(typeof APP.start==='function')APP.start()});\n    }\n);\n","window['#$']=function(exports,module){  exports.config={\n    name:\"webgl-experiments\",\n    description:\"WebGL experiments\",\n    author:\"Tolokoban\",\n    version:\"0.0.181\",\n    major:0,\n    minor:0,\n    revision:181,\n    date:new Date(2016,1,8,13,53,11)\n};\nvar currentLang = null;\nexports.lang = function(lang) {\n    if (lang === undefined) {\n        lang = window.localStorage.getItem(\"Language\");\n        if (!lang) {\n            lang = window.navigator.language;\n            if (!lang) {\n                lang = window.navigator.browserLanguage;\n                if (!lang) {\n                    lang = \"fr\";\n                }\n            }\n        }\n        lang = lang.substr(0, 2).toLowerCase();\n    }\n    currentLang = lang;\n    window.localStorage.setItem(\"Language\", lang);\n    return lang;\n};\nexports.intl = function(words, params) {\n    var dic = words[exports.lang()],\n    k = params[0],\n    txt, newTxt, i, c, lastIdx, pos;\n    if (!dic) {\n        //console.error(\"Missing internationalization for language : \\\"\" + exports.lang() + \"\\\"!\");\n        return k;\n    }\n    txt = dic[k];\n    if (!txt) {\n        //console.error(\"Missing internationalization [\" + exports.lang() + \"]: \\\"\" + k + \"\\\"!\");\n        return k;\n    }\n    if (params.length > 1) {\n        newTxt = \"\";\n        lastIdx = 0;\n        for (i = 0 ; i < txt.length ; i++) {\n            c = txt.charAt(i);\n            if (c === '$') {\n                newTxt += txt.substring(lastIdx, i);\n                i++;\n                pos = txt.charCodeAt(i) - 48;\n                if (pos < 0 || pos >= params.length) {\n                    newTxt += \"$\" + txt.charAt(i);\n                } else {\n                    newTxt += params[pos];\n                }\n                lastIdx = i + 1;\n            } else if (c === '\\\\') {\n                newTxt += txt.substring(lastIdx, i);\n                i++;\n                newTxt += txt.charAt(i);\n                lastIdx = i + 1;\n            }\n        }\n        newTxt += txt.substr(lastIdx);\n        txt = newTxt;\n    }\n    return txt;\n};\n }\n","window['#main']=function(exports,module){ var _intl_={\"en\":{\"welcome\":\"Welcome in the world of\"},\"fr\":{\"welcome\":\"Bienvenue dans le monde de\"}},_$=require(\"$\").intl;function _(){return _$(_intl_, arguments);}\n var Cube = require(\"taquin.cube\");\r\nvar Grid = require(\"taquin.grid\");\r\nvar HollowCube = require(\"taquin.hollow-cube\");\r\nvar RotateTouch = require(\"taquin.rotate-touch\");\r\n\r\nvar W = Math.min( window.innerWidth, window.innerHeight );\r\nvar H = W;\r\nvar scene = new THREE.Scene();\r\nvar camera = new THREE.PerspectiveCamera( 35, W / H, 0.1, 1000 );\r\nvar renderer = new THREE.WebGLRenderer();\r\nrenderer.setSize( W, H );\r\ndocument.body.appendChild( renderer.domElement );\r\n\r\n\r\nvar selectedCube = null;\r\nvar nextSelectedCube = null;\r\nvar actions = [];\r\n\r\nvar mouse = { x: 0, y: 0 };\r\nrenderer.domElement.addEventListener('mousemove', function(event) {\r\n    mouse.x = ( event.clientX / W ) * 2 - 1;\r\n    mouse.y = - ( event.clientY / H ) * 2 + 1;\r\n});\r\nrenderer.domElement.addEventListener('mousedown', function(event) {\r\n    actions.push(\"MOUSEDOWN\");\r\n});\r\nrenderer.domElement.addEventListener('touchstart', function(event) {\r\n    mouse.x = ( event.clientX / W ) * 2 - 1;\r\n    mouse.y = - ( event.clientY / H ) * 2 + 1;\r\n    actions.push(\"MOUSEDOWN\");\r\n});\r\n\r\n\r\nvar material, material2 = new THREE.MeshPhongMaterial({\r\n    color: 0xff0000,\r\n    specular: 0x333333,\r\n    shininess: 15,\r\n    map: null,\r\n    specularMap: null,\r\n    normalMap: null\r\n});\r\n\r\nvar light1 = new THREE.DirectionalLight( 0xdddddd, 0.8 );\r\nvar light2 = new THREE.DirectionalLight( 0x9999ff, 0.5 );\r\nvar group = new THREE.Group();\r\n\r\nscene.add( light1 );\r\nscene.add( light2 );\r\n\r\nvar grid = new Grid(3,3,3);\r\nvar x, y, z, cube;\r\nfor (x=0 ; x<3 ; x++) {\r\n    for (y=0 ; y<3 ; y++) {\r\n        for (z=0 ; z<3 ; z++) {\r\n            if (x != 1 || y != 1 || z != 1) {\r\n                cube = Cube(x, y, z);\r\n                grid.cube(x, y, z, cube);\r\n                group.add(cube);\r\n            }\r\n        }\r\n    }\r\n}\r\nmaterial = cube.material;\r\n\r\nvar hollow = HollowCube(3);\r\nvar hole = createHole();\r\ngrid.setHole( hole );\r\nhollow.add(hole);\r\nvar grpA = new THREE.Group();\r\ngrpA.add(group);\r\nvar grpB = new THREE.Group();\r\ngrpB.add(hollow);\r\n\r\ngrpA.position.set(-.2, .2, -.5);\r\ngrpB.position.set(1.7, -1.7, 1);\r\ngrpB.scale.set(.3,.3,.3);\r\n\r\nscene.add( grpA );\r\nscene.add( grpB );\r\n\r\ncamera.position.z = 9;\r\nlight1.position.set(3,0,5);\r\nlight2.position.set(-1,2,4);\r\nvar time0 = Date.now();\r\ngroup.rotation.x = 0;\r\ngroup.rotation.y = 0;\r\ngroup.rotation.z = 0;\r\n\r\nvar touch = new RotateTouch(renderer.domElement);\r\n\r\nfunction render(time1) {\r\n    var deltaTime = time1 - time0;\r\n    touch.applyRotation(group, deltaTime);\r\n    touch.applyRotation(hollow, deltaTime);\r\n    time0 = time1;\r\n    touch.rotation.speedX *= .95;\r\n    touch.rotation.speedY *= .95;\r\n\r\n    if (!grid.anim(time1)) {\r\n        if (touch.tap()) {\r\n            var raycaster = new THREE.Raycaster();\r\n            var vector = new THREE.Vector3( touch.x, touch.y, 1 ).unproject( camera );\r\n            raycaster.set( camera.position, vector.sub( camera.position ).normalize() );\r\n            var intersects = raycaster.intersectObjects( group.children );\r\n            var cube = intersects.length > 0 ? intersects[0].object : null;\r\n            if (cube) {\r\n                grid.tap(cube, time1);\r\n            }\r\n        }\r\n    }\r\n\r\n    requestAnimationFrame( render );\r\n    renderer.render( scene, camera );\r\n}\r\nrequestAnimationFrame( render );\r\n\r\n\r\n\r\nfunction createHole(s) {\r\n    if (typeof s === 'undefined') s = .5;\r\n\r\n    var colors = [\r\n        new THREE.Color(0,1,0),\r\n        new THREE.Color(0,1,1),\r\n        new THREE.Color(0,0,1),\r\n        new THREE.Color(1,0,0),\r\n        new THREE.Color(1,1,0),\r\n        new THREE.Color(1,0,1)\r\n    ];\r\n    var geo = new THREE.Geometry();\r\n    geo.vertices.push(\r\n        new THREE.Vector3( s, s, s),\r\n        new THREE.Vector3( s, s,-s),\r\n        new THREE.Vector3(-s, s,-s),\r\n        new THREE.Vector3(-s, s, s),\r\n        new THREE.Vector3( s,-s, s),\r\n        new THREE.Vector3( s,-s,-s),\r\n        new THREE.Vector3(-s,-s,-s),\r\n        new THREE.Vector3(-s,-s, s)\r\n    );\r\n    [\r\n        [0,1,2,3], [0,4,5,1], [1,5,6,2], [2,6,7,3], [0,3,7,4], [4,7,6,5]\r\n    ].forEach(function (vertices, idx) {\r\n        var face1 = new THREE.Face3( vertices[0], vertices[1], vertices[2] );\r\n        var face2 = new THREE.Face3( vertices[0], vertices[2], vertices[3] );\r\n        face1.vertexColors[0] = face1.vertexColors[1] = face1.vertexColors[2] = colors[idx];\r\n        face2.vertexColors[0] = face2.vertexColors[1] = face2.vertexColors[2] = colors[idx];\r\n        geo.faces.push( face1, face2 );\r\n    });\r\n\r\n    geo.computeFaceNormals ();\r\n    geo.computeVertexNormals ();\r\n    \r\n    var mat = new THREE.MeshPhongMaterial({\r\n        specular: 0x111111,\r\n        shininess: 2,\r\n        vertexColors: THREE.VertexColors        \r\n    });\r\n\r\n    return new THREE.Mesh( geo, mat );\r\n}\r\n }\n","window['#taquin.rotate-touch']=function(exports,module){  var MOUSEDOWN = 1;\r\nvar TOUCHSTART = 2;\r\n\r\nvar X_AXIS = new THREE.Vector3(1,0,0);\r\nvar Y_AXIS = new THREE.Vector3(0,1,0);\r\n\r\n/**\r\n * Deal with touch/mouse gestures to make an object rotate.\r\n *\r\n * @param canvas {canvas} - the canvas on with we will attach touch/mouse events.\r\n * @param mesh {THREE.Mesh} - the object to rotate according to gestures.\r\n */\r\nvar RotateTouch = function(canvas) {\r\n    var that = this;\r\n    this.x = 0;\r\n    this.y = 0;\r\n    this._tap = false;\r\n    this.rotation = { speedX: Math.random() * .01, speedY: Math.random() * .01 };\r\n    var status = 0;\r\n    var timeTouchStart = 0;\r\n    var time0 = 0;\r\n    canvas.addEventListener(\"touchstart\", function(evt) {\r\n        evt.preventDefault();\r\n        evt.stopPropagation();\r\n        status = TOUCHSTART;\r\n        timeTouchStart = time0 = Date.now();\r\n        var touches = evt.changedTouches;\r\n        if (touches.length > 0) {\r\n            that.x = ( touches[0].clientX / canvas.width ) * 2 - 1;\r\n            that.x0 = that.x;\r\n            that.y = -( touches[0].clientY / canvas.height ) * 2 + 1;\r\n            that.y0 = that.y;\r\n        }\r\n        // Stop rotation as soon as the user touches the screen.\r\n        that.rotation.speedX = that.rotation.speedY = 0;\r\n    });\r\n    canvas.addEventListener(\"touchend\", function(evt) {\r\n        if (status != TOUCHSTART) return;\r\n        evt.preventDefault();\r\n        evt.stopPropagation();\r\n        var deltaTime = Date.now() - timeTouchStart;\r\n        if (deltaTime > 400) return;\r\n        var x, y;\r\n        var touches = evt.changedTouches;\r\n        if (touches.length > 0) {\r\n            x = ( touches[0].clientX / canvas.width ) * 2 - 1;\r\n            y = -( touches[0].clientY / canvas.height ) * 2 + 1;\r\n        }\r\n        var dis = Math.max(Math.abs(that.x0 - x), Math.abs(that.y0 - y));\r\n        if (dis > 0.05) return;\r\n        that._tap = true;\r\n    });\r\n    canvas.addEventListener(\"touchmove\", function(evt) {\r\n        if (status != TOUCHSTART) return;\r\n        evt.preventDefault();\r\n        var touches = evt.changedTouches;\r\n        var x, y;\r\n        if (touches.length > 0) {\r\n            x = ( touches[0].clientX / canvas.width ) * 2 - 1;\r\n            y = -( touches[0].clientY / canvas.height ) * 2 + 1;\r\n            var time1 = Date.now();\r\n            var deltaTime = Math.max(0.001, time1 - time0);\r\n            that.rotation.speedY = (x - that.x) / deltaTime;\r\n            that.rotation.speedX = (y - that.y) / deltaTime;\r\n            that.x = x;\r\n            that.y = y;\r\n            time0 = time1;\r\n        }\r\n    });\r\n\r\n    canvas.addEventListener(\"mousedown\", function(evt) {\r\n        evt.preventDefault();\r\n        evt.stopPropagation();\r\n        status = MOUSEDOWN;\r\n        timeTouchStart = time0 = Date.now();\r\n        that.x = ( evt.clientX / canvas.width ) * 2 - 1;\r\n        that.x0 = that.x;\r\n        that.y = -( evt.clientY / canvas.height ) * 2 + 1;\r\n        that.y0 = that.y;\r\n        // Stop rotation as soon as the user touches the screen.\r\n        that.rotation.speedX = that.rotation.speedY = 0;\r\n    });\r\n    canvas.addEventListener(\"mouseup\", function(evt) {\r\n        if (status != MOUSEDOWN) return;\r\n        status = 0;\r\n        evt.preventDefault();\r\n        evt.stopPropagation();\r\n        var deltaTime = Date.now() - timeTouchStart;\r\n        if (deltaTime > 400) return;\r\n        var x, y;\r\n        x = ( evt.clientX / canvas.width ) * 2 - 1;\r\n        y = -( evt.clientY / canvas.height ) * 2 + 1;\r\n        var dis = Math.max(Math.abs(that.x0 - x), Math.abs(that.y0 - y));\r\n        if (dis > 0.05) return;\r\n        that._tap = true;\r\n    });\r\n    canvas.addEventListener(\"mousemove\", function(evt) {\r\n        if (status != MOUSEDOWN) return;\r\n        evt.preventDefault();\r\n        var touches = evt.changedTouches;\r\n        var x, y;\r\n        x = ( evt.clientX / canvas.width ) * 2 - 1;\r\n        y = -( evt.clientY / canvas.height ) * 2 + 1;\r\n        var time1 = Date.now();\r\n        var deltaTime = Math.max(0.001, time1 - time0);\r\n        that.rotation.speedY = (x - that.x) / deltaTime;\r\n        that.rotation.speedX = (y - that.y) / deltaTime;\r\n        that.x = x;\r\n        that.y = y;\r\n        time0 = time1;\r\n    });\r\n};\r\n\r\n\r\n/**\r\n * @return void\r\n */\r\nRotateTouch.prototype.applyRotation = function(mesh, deltaTime) {\r\n    var angX = this.rotation.speedX * deltaTime;\r\n    var angY = -this.rotation.speedY * deltaTime;\r\n    var Cx = Math.cos(angX);\r\n    var Sx = Math.sin(angX);\r\n    var Cy = Math.cos(angY);\r\n    var Sy = Math.sin(angY);\r\n    mesh.matrixAutoUpdate = false;\r\n    var rotation = new THREE.Matrix4();\r\n    var e = rotation.elements;\r\n    e[0]  = Cy;      e[1]  = 0;      e[2]  = Sy;      e[3]  = 0;\r\n    e[4]  = Sx*Sy;   e[5]  = Cx;     e[6]  = -Cy*Sx;  e[7]  = 0;\r\n    e[8]  = -Cx*Sy;  e[9]  = Sx;     e[10] = Cx*Cy;   e[11] = 0;\r\n    e[12] = 0;       e[13] = 0;      e[14] = 0;       e[15] = 1;\r\n\r\n    mesh.matrix = rotation.multiply( mesh.matrix );\r\n};\r\n\r\n\r\n/**\r\n * @return void\r\n */\r\nRotateTouch.prototype.tap = function() {\r\n    if (this._tap) {\r\n        this._tap = false;\r\n        return true;\r\n    }\r\n    return false;\r\n};\r\n\r\n\r\nmodule.exports = RotateTouch;\r\n }\n","window['#taquin.hollow-cube']=function(exports,module){  module.exports = function(side) {\r\n    if (typeof side === 'undefined') side = 1;\r\n\r\n    var grp = new THREE.Group();\r\n\r\n    var mat1 = new THREE.LineBasicMaterial({ color: new THREE.Color(.5,.5,.5), linewidth: 1 });\r\n    var mat0 = new THREE.LineBasicMaterial({ color: new THREE.Color(.1,.1,.1), linewidth: 1 });\r\n    var a, b;\r\n    var i, j;\r\n    var c = side/2;\r\n    var line;\r\n    var mat;\r\n    for ( i=0 ; i<4 ; i++ ) {\r\n        a = (i - 1.5) * c / 1.5;\r\n        for ( j=0 ; j<4 ; j++ ) {\r\n            b = (j - 1.5) * c / 1.5;\r\n            if ( (i == 0 || i == 3) && (j == 0 || j == 3) ) {\r\n                mat = mat1;\r\n            } else {\r\n                mat = mat0;\r\n            }\r\n            line = new THREE.Geometry();\r\n            line.vertices.push(\r\n                new THREE.Vector3(a, b, -c),\r\n                new THREE.Vector3(a, b, c)\r\n            );\r\n            grp.add( new THREE.Line( line, mat ) );\r\n            line = new THREE.Geometry();\r\n            line.vertices.push(\r\n                new THREE.Vector3(a, -c, b),\r\n                new THREE.Vector3(a, c, b)\r\n            );\r\n            grp.add( new THREE.Line( line, mat ) );\r\n            line = new THREE.Geometry();\r\n            line.vertices.push(\r\n                new THREE.Vector3(-c, a, b),\r\n                new THREE.Vector3(c, a, b)\r\n            );\r\n            grp.add( new THREE.Line( line, mat ) );\r\n        }\r\n    }\r\n    return grp;\r\n};\r\n }\n","window['#taquin.grid']=function(exports,module){  /***************************************\r\n\r\n ***************************************/\r\n\r\nvar ANIM_SCALE = 1;\r\nvar ANIM_MOVE = 2;\r\n\r\n\r\nvar Grid = function(dx, dy, dz) {\r\n    this._cubes = [];\r\n    for (var loop = 0 ; loop < dx*dy*dz ; loop++) {\r\n        this._cubes.push(null);\r\n    }\r\n    this._dx = dx;\r\n    this._dy = dy;\r\n    this._dz = dz;\r\n    this._anim = {\r\n        start: 0,\r\n        end: 0,\r\n        cube: null,\r\n        type: 0,\r\n        x0: 0, x1: 0,\r\n        y0: 0, y1: 0,\r\n        z0: 0, z1: 0\r\n    };\r\n};\r\n\r\n\r\n/**\r\n * @return void\r\n */\r\nGrid.prototype.setHole = function( hole ) {\r\n    this._hole = hole;\r\n};\r\n\r\n\r\n/**\r\n * @return void\r\n */\r\nGrid.prototype.anim = function(time) {\r\n    var hole = this._hole;\r\n    var anim = this._anim;\r\n    if (!anim.cube) return false;\r\n    var dur = anim.end - anim.start;\r\n    if (anim.type == ANIM_SCALE) {\r\n        if (time >= anim.end) {\r\n            // End of animation. Set the scale to 1.\r\n            anim.cube.scale.x = 1;\r\n            anim.cube.scale.y = 1;\r\n            anim.cube.scale.z = 1;\r\n            anim.cube = null;\r\n        } else {\r\n            var scale = 1 - .75 * Math.sin(Math.PI * (time - anim.start) / dur);\r\n            anim.cube.scale.x = anim.cube.scale.y = anim.cube.scale.z = scale;\r\n        }\r\n    } else {\r\n        if (time >= anim.end) {\r\n            // End of animation. Set the to target position.\r\n            anim.cube.position.x = anim.x1;\r\n            anim.cube.position.y = anim.y1;\r\n            anim.cube.position.z = anim.z1;\r\n            anim.cube = null;\r\n        } else {\r\n            anim.cube.position.x = anim.x0 + (anim.x1 - anim.x0) * (time - anim.start) / dur;\r\n            anim.cube.position.y = anim.y0 + (anim.y1 - anim.y0) * (time - anim.start) / dur;\r\n            anim.cube.position.z = anim.z0 + (anim.z1 - anim.z0) * (time - anim.start) / dur;\r\n        }\r\n        if (hole) {\r\n            if (time >= anim.end) {\r\n                // End of animation. Set the to target position.\r\n                hole.position.x = anim.x0;\r\n                hole.position.y = anim.y0;\r\n                hole.position.z = anim.z0;\r\n                hole = null;\r\n            } else {\r\n                hole.position.x = anim.x1 + (anim.x0 - anim.x1) * (time - anim.start) / dur;\r\n                hole.position.y = anim.y1 + (anim.y0 - anim.y1) * (time - anim.start) / dur;\r\n                hole.position.z = anim.z1 + (anim.z0 - anim.z1) * (time - anim.start) / dur;\r\n            }\r\n        }\r\n    }\r\n    return true;\r\n};\r\n\r\n\r\n/**\r\n * @return void\r\n */\r\nGrid.prototype.tap = function(cube, time) {\r\n    var coords = this.find(cube);\r\n    if (!coords) return;\r\n    var cx = coords.x;\r\n    var cy = coords.y;\r\n    var cz = coords.z;\r\n    var x = cube.position.x;\r\n    var y = cube.position.y;\r\n    var z = cube.position.z;\r\n    var vect = null;\r\n    if (this.cube(cx + 1, cy + 0, cz + 0) === null) {\r\n        vect = [1,0,0];\r\n    }\r\n    else if (this.cube(cx - 1, cy + 0, cz + 0) === null) {\r\n        vect = [-1,0,0];\r\n    }\r\n    else if (this.cube(cx + 0, cy + 1, cz + 0) === null) {\r\n        vect = [0,1,0];\r\n    }\r\n    else if (this.cube(cx + 0, cy - 1, cz + 0) === null) {\r\n        vect = [0,-1,0];\r\n    }\r\n    else if (this.cube(cx + 0, cy + 0, cz + 1) === null) {\r\n        vect = [0,0,1];\r\n    }\r\n    else if (this.cube(cx + 0, cy + 0, cz - 1) === null) {\r\n        vect = [0,0,-1];\r\n    }\r\n    if (!vect) {\r\n        this._anim = {\r\n            cube: cube,\r\n            type: ANIM_SCALE,\r\n            start: time,\r\n            end: time + 300\r\n        };\r\n    } else {\r\n        this._anim = {\r\n            cube: cube,\r\n            type: ANIM_MOVE,\r\n            start: time,\r\n            end: time + 300,\r\n            x0: x, y0: y, z0: z,\r\n            x1: x + vect[0], y1: y + vect[1], z1: z + vect[2]\r\n        };\r\n        this.cube(cx + vect[0], cy + vect[1], cz + vect[2], cube);\r\n        this.cube(cx, cy, cz, null);\r\n        console.info(\"[taquin.grid] this._anim=...\", this._anim);\r\n    }\r\n};\r\n\r\n\r\n/**\r\n * @return void\r\n */\r\nGrid.prototype.cube = function(x, y, z, cube) {\r\n    if ( x < 0 || y < 0 || z < 0 ) return undefined;\r\n    if ( x > 2 || y > 2 || z > 2 ) return undefined;\r\n    var index = Math.floor(x + y * this._dx + z * this._dx * this._dy);\r\n    if (index < 0 || index >= this._cubes.length) return undefined;\r\n    if (typeof cube === 'undefined') return this._cubes[index];\r\n    this._cubes[index] = cube;\r\n    return this;\r\n};\r\n\r\n\r\n/**\r\n * @return void\r\n */\r\nGrid.prototype.find = function(cube) {\r\n    var x, y, z;\r\n    for (z=0 ; z<this._dz; z++) {\r\n        for (y=0 ; y<this._dy; y++) {\r\n            for (x=0 ; x<this._dx; x++) {\r\n                if (cube === this.cube(x, y, z)) return { x: x, y: y, z: z };\r\n            }\r\n        }\r\n    }\r\n    return null;\r\n};\r\n\r\n\r\nmodule.exports = Grid;\r\n }\n","window['#taquin.cube']=function(exports,module){  var TEXTURE_SIDE = 128;\r\n\r\n\r\nmodule.exports = function(x, y, z) {\r\n    var color = \"#\" + (x > 0 ? '77' : 'ff') + (y > 0 ? '77' : 'ff') + (z > 0 ? '77' : 'ff');\r\n    var materials = [\r\n        // Left\r\n        createMaterial(\r\n            [\r\n                \"abcdefghi\".charAt(z + 3*y),\r\n                \" \",\r\n                \"IHGFEDCBA\".charAt(z + 3*y)\r\n            ][x],\r\n            [\"#0ff\", \"#8bb\", \"#0bb\"][x]),\r\n        // Right\r\n        createMaterial(\r\n            [\r\n                \"IHGFEDCBA\".charAt(2 - z + 3*y),\r\n                \" \",\r\n                \"abcdefghi\".charAt(2 - z + 3*y)\r\n            ][x],\r\n            [\"#f00\", \"#b44\", \"#b00\"][x]),\r\n        // Up\r\n        createMaterial(\r\n            [\r\n                \"ihgfedcba\".charAt(x + 3*z),\r\n                \" \",\r\n                \"ABCDEFGHI\".charAt(x + 3*z)\r\n            ][y],\r\n            [\"#0f0\", \"#4b4\", \"#0b0\"][y]),\r\n        // Down\r\n        createMaterial(\r\n            [\r\n                \"IHGFEDCBA\".charAt(2 - x + 3*z),\r\n                \" \",\r\n                \"abcdefghi\".charAt(2 - x + 3*z)\r\n            ][y],\r\n            [\"#f0f\", \"#b8b\", \"#b0b\"][y]),\r\n        // Back\r\n        createMaterial(\r\n            [\r\n                \"abcdefghi\".charAt(2 - x + 3*y),\r\n                \" \",\r\n                \"IHGFEDCBA\".charAt(2 - x + 3*y)\r\n            ][z],\r\n            [\"#ff0\", \"#bb8\", \"#bb0\"][z]),\r\n        // Front\r\n        createMaterial(\r\n            [\r\n                \"IHGFEDCBA\".charAt(x + 3*y),\r\n                \" \",\r\n                \"abcdefghi\".charAt(x + 3*y)\r\n            ][z],\r\n            [\"#00f\", \"#44b\", \"#00b\"][z])\r\n    ];\r\n    var mesh = new THREE.Mesh(\r\n        new THREE.BoxGeometry( 1, 1, 1, 1, 1, 1 ),\r\n        new THREE.MeshFaceMaterial( materials )\r\n    );\r\n\r\n    mesh.position.set(x - 1, y - 1, z - 1);\r\n    return mesh;\r\n};\r\n\r\n\r\n\r\n\r\nfunction createCanvas(text, color) {\r\n    var canvas = document.createElement(\"canvas\");\r\n    var W = TEXTURE_SIDE, H = TEXTURE_SIDE;\r\n    canvas.width = W;\r\n    canvas.height = H;\r\n    var ctx = canvas.getContext(\"2d\");\r\n\r\n    ctx.fillStyle = color;\r\n    ctx.fillRect(0, 0, W, H);\r\n    ctx.font = 'Bold ' + Math.floor(W * 3 / 4) + 'px Arial';\r\n    ctx.textAlign = \"center\";\r\n    ctx.textBaseline = \"middle\";\r\n    ctx.fillStyle = \"#000\";\r\n    ctx.fillText(text, W / 2, H / 2);\r\n\r\n    return canvas;\r\n}\r\n\r\nfunction createTexture(text, color) {\r\n    var texture = new THREE.Texture(  createCanvas(text, color) );\r\n    texture.needsUpdate = true;\r\n    return texture;\r\n}\r\n\r\nfunction createBump(text) {\r\n    var canvas = document.createElement(\"canvas\");\r\n    var W = TEXTURE_SIDE, H = TEXTURE_SIDE;\r\n    canvas.width = W;\r\n    canvas.height = H;\r\n    var ctx = canvas.getContext(\"2d\");\r\n\r\n    ctx.fillStyle = \"#000\";\r\n    ctx.fillRect(0, 0, W, H);\r\n    ctx.fillStyle = \"#777\";\r\n    ctx.fillRect(1, 1, W - 2, H - 2);\r\n    var shift = Math.random() * canvas.width * 2 - canvas.width;\r\n    var x = Math.min(-shift, 0);\r\n    var color = Math.floor(122 + Math.random() * 4);\r\n    while (x < Math.max(canvas.width, canvas.width - shift)) {\r\n        ctx.strokeStyle = \"rgb(\" + color + \",\" + color + \",\" + color + \")\";\r\n        ctx.beginPath();\r\n        ctx.moveTo(x, 0);\r\n        ctx.lineTo(x + shift, W);\r\n        ctx.stroke();\r\n        x += 2 + Math.random() * 5;\r\n    }\r\n    ctx.font = 'Bold ' + Math.floor(W * 3 / 4) + 'px Arial';\r\n    ctx.textAlign = \"center\";\r\n    ctx.textBaseline = \"middle\";\r\n    ctx.fillStyle = \"rgba(255, 255, 255, .3)\";\r\n    var x, y;\r\n    for (y = -2 ; y < 3 ; y++) {\r\n        for (x = -2 ; x < 3 ; x++) {\r\n            ctx.fillText(text, W / 2 + x, H / 2 + y);\r\n        }\r\n    }\r\n\r\n    var texture = new THREE.Texture(  canvas );\r\n    texture.needsUpdate = true;\r\n    return texture;\r\n}\r\n\r\nfunction createMaterial(text, color) {\r\n    return new THREE.MeshPhongMaterial({\r\n        specular: 0x333333,\r\n        shininess: 25,\r\n        transparent: true,\r\n        opacity: .6,\r\n        map: createTexture(text, color),\r\n        specularMap: null,\r\n        bumpMap: createBump(text)\r\n    });\r\n}\r\n }\n"],"names":["addListener","e","l","window","addEventListener","attachEvent","require","modules","id","body","mod","err","Error","console","error","stack","exports","document","parentNode","$data","APP","setTimeout","start","window","exports","module","config","name","description","author","version","major","minor","revision","date","Date","currentLang","lang","undefined","localStorage","getItem","navigator","language","browserLanguage","substr","toLowerCase","setItem","intl","words","params","txt","newTxt","i","c","lastIdx","pos","dic","k","length","charAt","substring","charCodeAt","window","exports","module","render","time1","deltaTime","time0","touch","applyRotation","group","hollow","rotation","speedX","speedY","grid","anim","tap","raycaster","THREE","Raycaster","vector","Vector3","x","y","unproject","camera","set","position","sub","normalize","intersects","intersectObjects","children","cube","length","object","requestAnimationFrame","renderer","scene","createHole","s","colors","Color","geo","Geometry","vertices","push","forEach","idx","face1","Face3","face2","vertexColors","faces","computeFaceNormals","computeVertexNormals","mat","MeshPhongMaterial","specular","shininess","VertexColors","Mesh","Cube","require","intl","Grid","HollowCube","RotateTouch","W","Math","min","innerWidth","innerHeight","H","Scene","PerspectiveCamera","WebGLRenderer","setSize","document","body","appendChild","domElement","actions","mouse","addEventListener","event","clientX","clientY","material","light1","color","map","specularMap","normalMap","DirectionalLight","light2","Group","add","z","hole","setHole","grpA","grpB","scale","Date","now","window","exports","module","MOUSEDOWN","TOUCHSTART","RotateTouch","THREE","Vector3","canvas","that","this","x","y","_tap","rotation","speedX","Math","random","speedY","status","timeTouchStart","time0","addEventListener","evt","preventDefault","stopPropagation","Date","now","touches","changedTouches","length","clientX","width","x0","clientY","height","y0","deltaTime","dis","max","abs","time1","prototype","applyRotation","mesh","angX","angY","Cx","cos","Sx","sin","Cy","Sy","matrixAutoUpdate","Matrix4","e","elements","matrix","multiply","tap","window","exports","module","side","a","b","i","j","line","mat","grp","THREE","Group","mat1","LineBasicMaterial","color","Color","linewidth","mat0","c","Geometry","vertices","push","Vector3","add","Line","window","exports","module","ANIM_SCALE","ANIM_MOVE","Grid","dx","dy","dz","this","_cubes","loop","push","_dx","_dy","_dz","_anim","start","end","cube","type","x0","x1","y0","y1","z0","z1","prototype","setHole","hole","_hole","anim","time","dur","scale","x","y","z","Math","sin","PI","position","tap","coords","find","cx","cy","cz","vect","console","info","index","floor","length","window","exports","module","createCanvas","text","color","canvas","document","createElement","W","TEXTURE_SIDE","H","width","height","ctx","getContext","fillStyle","fillRect","font","Math","floor","textAlign","textBaseline","fillText","createTexture","texture","THREE","Texture","needsUpdate","createBump","shift","random","x","min","max","strokeStyle","beginPath","moveTo","lineTo","stroke","y","createMaterial","MeshPhongMaterial","specular","shininess","transparent","opacity","map","specularMap","bumpMap","z","materials","charAt","mesh","Mesh","BoxGeometry","MeshFaceMaterial","position","set"],"mappings":"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"}